<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Works · Shuyu Zhang</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Savate:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

  <!-- Global stylesheet -->
  <link rel="stylesheet" href="style.css">

  <!-- Inline tweaks for Works page -->
  <style>
    /* -------------- Works grid test -------------- */
    .works-page .work-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(500px,1fr));
      gap:5rem 4rem;
    }

    /* -------------- Card hover overlay -------------- */
    .work-card .overlay{
      font-weight:600;
      line-height:1.35;
      white-space:normal;   /* ⬅︎ 保证换行生效 */
      pointer-events:none;  /* ← 就加这一行 */
      flex-direction:column;  /* ← 新增：改成纵向排布 */
    }
    .work-card .overlay small{
      display:block;        /* 换行到第二行 */
      font-size:.8rem;
      font-weight:400;
      margin-top:.25rem;
      opacity:.85;
    }

    /* -------------- Modal -------------- */
    .modal-overlay{
      position:fixed;inset:0;display:flex;justify-content:center;align-items:center;
      background:rgba(0,0,0,.6);z-index:999;
    }
    .hidden{display:none}
    .modal{
      width:96%;               /* 再加宽一点 */
      max-width:1100px;        /* 由 900 → 1100 */
      max-height:93vh;
      overflow-y:auto;
      background:#111;color:#eee;
      padding:36px 36px 48px;
      border-radius:20px;
      position:relative;
    }
    .modal .close{
      position:absolute;top:22px;right:26px;font-size:34px;line-height:1;
      background:none;border:none;color:#ddd;cursor:pointer;z-index:10;
    }
    .modal .close:hover{color:#fff}

    .videoWrap{position:relative;width:100%;padding-top:56.25%}
    .videoWrap iframe{position:absolute;inset:0;width:100%;height:100%}

    .intro{margin:30px 0;line-height:1.65;font-size:1rem}

    .photos{
      display:grid;gap:16px;
      grid-template-columns:repeat(auto-fill,minmax(47%,1fr));
    }
    .photos img{
      width:100%;height:auto;          /* 等比放大 */
      border-radius:10px;
    }
  </style>
</head>
<body class="page-dark works-page">

  <!-- ===== Navbar ===== -->
  <nav class="nav">
    <div class="nav-inner container">
      <a href="index.html" class="brand">SHUYU&nbsp;ZHANG</a>
      <ul class="nav-list">
        <li><a href="about.html">About</a></li>
        <li><a href="works.html">Works</a></li>
        <li><a href="practice.html">Self&nbsp;Practice</a></li>
        <li><a href="cv.html">CV</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- ===== Works Section ===== -->
  <main class="container">
    <h1 class="page-title">Works</h1>
    <div class="work-grid">
      <!-- Card: Yu (opens modal) -->
      <article id="yu" class="work-card" data-sign="1">
        <img class="work-cover" src="assets/photo/dancer15.jpg" alt="Hiphop dancer Yu">
        <div class="overlay">Hiphop dancer Yu<small>installation performance &amp; game · 2024</small></div>
        <button class="close-btn" aria-label="Close">&times;</button>
      </article>
      <!-- Other cards unchanged -->
      <article id="flower" class="work-card" data-sign="-1">
        <img class="work-cover" src="assets/img/works/mycelium.jpg" alt="flower day and night">
        <div class="overlay">flower day and night<small>JavaScript · 2024</small></div>
        <button class="close-btn" aria-label="Close">&times;</button>
      </article>
      <article id="mocap" class="work-card" data-sign="1">
        <img class="work-cover" src="assets/img/works/digitalbloom.jpg" alt="Mocap">
        <div class="overlay">mocap<small>MotionCapture Unity VR · 2023</small></div>
        <button class="close-btn" aria-label="Close">&times;</button>
      </article>
      <article id="water" class="work-card" data-sign="-1">
        <img class="work-cover" src="assets/img/works/liquidmemory.jpg" alt="Liquid Memory">
        <div class="overlay">Liquid Memory<small>Installation Arduino · 2024</small></div>
        <button class="close-btn" aria-label="Close">&times;</button>
      </article>
      <article id="AI" class="work-card" data-sign="1">
        <img class="work-cover" src="assets/img/works/mechanicalgarden.jpg" alt="Mechanical Garden">
        <div class="overlay">dream<small>Unreal Engine 4 · 2023</small></div>
        <button class="close-btn" aria-label="Close">&times;</button>
      </article>
    </div>
  </main>

  <!-- ===== Modal (Yu) ===== -->
  <div id="modalOverlay" class="modal-overlay hidden" role="dialog" aria-modal="true">
    <div class="modal">
      <button id="closeModal" class="close" aria-label="Close">&times;</button>
      <div class="videoWrap">
        <iframe id="youtubeVideo"
                src="https://www.youtube.com/embed/fQroMDVXbRU?enablejsapi=1"
                title="Hiphop dancer Yu"
                frameborder="0"
                allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
      </div>
      <p class="intro">Centered around the author-artist's favorite game <strong>Don't Starve Together</strong>, this work blends her coming-of-age story with the realities of China's street-dance scene. It tells the story of a young woman (the artist herself) living in a university dorm, torn between abandoning her passion for dance and the pressures of everyday life. When she is once again tormented by her own mediocrity in dance, the game's antagonist—Maxwell—appears, promising that entering "the Constant" (the game world) will make her a dance master. Tempted by Maxwell, she enters the Constant full of hope, only to discover it was all a trick: in this world, she is the only one who can dance, making her the dance master by default. In reality, she hasn't truly become a master, and must now rely on her limited dance skills to survive in the perilous, shadowy world. The project unfolds in two intertwined formats: an installation and live performance—the real world—and a custom game mod—the virtual world. This project marks the artist's first attempt at exploring the interaction between the virtual and the real, though she was not aware of it at the time. She tried to use the game to connect her real life and the virtual world, which, at that time, was simply a place for her to escape. After all, at least in the virtual world, she could become a dance master.</p>
      <div class="photos"></div>
    </div>
  </div>

  <!-- ===== Scripts ===== -->
<script>
// YouTube 播放器全局变量
let player;

// 加载YouTube API
const loadYouTubeAPI = () => {
  const tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  const firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
};

// 当YouTube API准备好时的回调
function onYouTubeIframeAPIReady() {
  player = new YT.Player('youtubeVideo', {
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

// 播放器准备就绪
function onPlayerReady(event) {
  // 可以在这里设置自动播放等
  // event.target.playVideo();
}

// 播放器状态变化
function onPlayerStateChange(event) {
  // 可以在这里处理播放状态变化
}

// 打开模态框
const openModal = (e) => {
  e.stopPropagation();
  const modalOverlay = document.getElementById('modalOverlay');
  modalOverlay.classList.remove('hidden');
  document.body.style.overflow = 'hidden';
  
  // 初始化或重新加载播放器
  if (!player) {
    loadYouTubeAPI();
  } else {
    // 如果播放器已存在，重新加载视频
    player.loadVideoById('fQroMDVXbRU');
  }
  
  loadPhotos();
};

// 关闭模态框
const closeModal = () => {
  if (player && player.stopVideo) {
    player.stopVideo();
  }
  
  const modalOverlay = document.getElementById('modalOverlay');
  modalOverlay.classList.add('hidden');
  document.body.style.overflow = '';
};

// 加载照片
function loadPhotos() {
  const photoBox = document.querySelector('.photos');
  const photoFiles = [
    'dancer13.jpg','dancer14.jpg','dancer15.jpg',
    'dancer.png','dancer (2).png','dancer (3).png',
    'dancer (4).png','dancer (5).png','dancer (6).png',
    'dancer (7).png','dancer (8).png','dancer (9).png',
    'dancer (10).png','dancer (11).png','dancer (12).png',
    'dancer13.jpg','dancer14.jpg','dancer15.jpg',
  ];
  
  photoBox.innerHTML = '';
  
  photoFiles.forEach(f => {
    const img = new Image();
    img.src = `assets/photo/${f}`;
    img.alt = f;
    img.loading = 'lazy';
    img.classList.add('gallery-img');
    photoBox.appendChild(img);
  });
}

// 页面加载完成后执行
(() => {
  /* ========== 进场动画 ========== */
  const cards = document.querySelectorAll('.work-card');
  const reveal = el => el.classList.add('in-view');

  if ('IntersectionObserver' in window) {
    const io = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          reveal(e.target);
          io.unobserve(e.target);
        }
      });
    }, { threshold: 0.3 });
    cards.forEach(c => io.observe(c));
  } else {
    cards.forEach(reveal);
  }

  /* ========== 滚动视差 ========== */
  function updateParallax() {
    const vh = innerHeight;
    document.querySelectorAll('.work-card.in-view:not(.expanded)').forEach(card => {
      const rect = card.getBoundingClientRect();
      const percent = (rect.top + rect.height / 2) / vh;
      const sign = parseInt(card.dataset.sign, 10) || 1;
      card.style.setProperty('--parallax', ((percent - 0.5) * 80 * sign).toFixed(1) + 'px');
    });
  }
  addEventListener('scroll', updateParallax, { passive: true });
  addEventListener('resize', updateParallax);
  addEventListener('load', updateParallax);

  // 确保模态框元素存在
  const modalOverlay = document.getElementById('modalOverlay');
  const closeModalBtn = document.getElementById('closeModal');
  const yuCard = document.getElementById('yu');

  // 为所有卡片添加点击处理
  cards.forEach(card => {
    const closeBtn = card.querySelector('.close-btn');
    const sign = parseInt(card.dataset.sign, 10) || 1;

    card.addEventListener('click', (e) => {
      if (card.id === 'yu') {
        openModal(e);
      } else {
        const r = card.getBoundingClientRect();
        card.style.setProperty('--original-top', `${r.top}px`);
        card.style.setProperty('--original-left', `${r.left}px`);
        card.style.setProperty('--original-width', `${r.width}px`);
        card.style.setProperty('--original-height', `${r.height}px`);
        card.classList.add('expanded', sign === 1 ? 'expanded-left' : 'expanded-right');
        document.body.style.overflow = 'hidden';
      }
    });

    closeBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      if (card.id === 'yu') {
        closeModal();
      } else {
        card.classList.remove('expanded', 'expanded-left', 'expanded-right');
        document.body.style.overflow = '';
      }
    });
  });

  // Modal 关闭处理
  closeModalBtn.addEventListener('click', closeModal);
  modalOverlay.addEventListener('click', e => { 
    if (e.target === modalOverlay) closeModal(); 
  });
  document.addEventListener('keydown', e => { 
    if (e.key === 'Escape' && !modalOverlay.classList.contains('hidden')) closeModal(); 
  });

  // 预加载YouTube API
  loadYouTubeAPI();
})();
</script>
</body>
</html>